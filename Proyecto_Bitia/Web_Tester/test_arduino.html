<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Bitia Project - Test Modular</title>
    <style>
        body { background: #111; color: #fff; font-family: sans-serif; text-align: center; padding: 50px; }
        button { padding: 15px 30px; font-size: 18px; cursor: pointer; margin: 10px; border-radius: 8px; border: none; }
        .btn-conn { background: #00d2ff; color: #000; font-weight: bold; }
        .btn-mode { background: #333; color: #fff; border: 1px solid #555; }
        .btn-mode:hover { background: #555; }
        #console { margin-top: 20px; color: #888; font-family: monospace; }
        #scrollIndicator { font-size: 60px; color: #ffcc00; margin: 20px; transition: transform 0.1s; }
    </style>
</head>
<body>

    <h1>üéõÔ∏è Control Bitia (Versi√≥n JS Modular)</h1>

    <button id="btnConnect" class="btn-conn">üîå CONECTAR</button>
    <div id="console">Esperando conexi√≥n...</div>

    <hr>

    <button class="btn-mode" onclick="app.setNucleo(0)">Iniciando</button>
    <button class="btn-mode" onclick="app.setNucleo(1)">N√∫cleo 1</button>
    <button class="btn-mode" onclick="app.setNucleo(2)">N√∫cleo 2</button>
    <button class="btn-mode" onclick="app.setNucleo(3)">N√∫cleo 3</button>

    <div id="scrollIndicator">0</div>

    <script type="module">
        import { BitiaConnector } from './bitia_connector.js';

        // Instanciamos nuestra clase
        const arduino = new BitiaConnector();
        let contadorScroll = 0;
        const display = document.getElementById('scrollIndicator');

        // 1. Conectar el bot√≥n de la interfaz a la l√≥gica
        document.getElementById('btnConnect').addEventListener('click', () => {
            arduino.conectar();
        });

        // 2. Definir qu√© pasa cuando el Arduino manda datos (CALLBACKS)
        
        // Cuando cambia el estado de conexi√≥n o hay mensajes
        arduino.onStatus = (mensaje) => {
            document.getElementById('console').innerText = mensaje;
        };

        // Cuando hay error
        arduino.onError = (err) => {
            alert(err);
        };

        //  Cuando giras el encoder (Aqu√≠ va tu l√≥gica de scroll futura)
        arduino.onScroll = (direccion) => {
            if (direccion === "CW") {
                contadorScroll++;
                display.style.transform = "translateY(10px)";
            } else {
                contadorScroll--;
                display.style.transform = "translateY(-10px)";
            }
            
            display.innerText = contadorScroll;

            // Resetear animaci√≥n visual
            setTimeout(() => display.style.transform = "translateY(0)", 100);
        };

        // Hacemos la variable 'app' global para que los botones onclick="" funcionen
        window.app = arduino;

    </script>
</body>
</html>
